<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:sec="http://www.springframework.org/security/facelets/tags"
	xmlns:util="http://java.sun.com/jsf/composite/components"
	xmlns:p="http://primefaces.org/ui">

<h:form id="formCadastroMsgDialog" prependId="false">

	<c:set var="isCadastro" value="true" scope="view" />

	<p:panel header="Cadastro de Mensagem" id="panelCadastroMsgDilog">

		<p:panelGrid id="gridMsgDialog" columns="3">

			<p:column>
				<p:row>
					<h:outputLabel for="idMsgDialog" value="Código: "
						id="labelIdmSgDialog" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<p:inputText id="idMsgDialog" readonly="true"
						value="#{mensagemBeanView.objetoSelecionado.mensagem_id}"
						style="width:300px;" />
				</p:row>
			</p:column>

			<p:column>

			</p:column>

			<p:column>
				<p:row>
					<h:outputLabel for="usr_origemMsgDialog" value="Origem: "
						id="labelOrigemDialog" style="width:300px;" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<p:inputText id="usr_origemMsgDialog" readonly="true"
						immediate="true"
						value="#{mensagemBeanView.objetoSelecionado.user_origem.ent_codigo}" />

					<p:inputText id="loginOrigemMsgDialog" readonly="true"
						immediate="true" required="true"
						requiredMessage="Usuário logado não carregado."
						value="#{mensagemBeanView.objetoSelecionado.user_origem.ent_login}"
						style="width:350px;" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<p:message for="loginOrigemMsgDialog" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<h:outputLabel for="usr_destinoMsgDialog" value="Destino: "
						id="labelDestinoDialog" style="width:300px;" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<p:inputText id="usr_destinoMsgDialog" immediate="false"
						value="#{mensagemBeanView.objetoSelecionado.user_destino.ent_codigo}"
						required="true" requiredMessage="Informe o usuário de destino."
						onblur="pesquisaUserDestinoPerderFocoDialog(this.value);" />

					<p:commandButton id="buttonPesquisarDestinoDialog" ajax="true"
						icon="imgPesquisa" immediate="true"
						oncomplete="destinoDialogMsgDialog.show();">

					</p:commandButton>

					<p:inputText id="loginDestinoMsgDialog" immediate="true"
						readonly="true"
						value="#{mensagemBeanView.objetoSelecionado.user_destino.ent_login}"
						required="true" requiredMessage="Informe o usuário de destino."
						style="width: 350px;" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<p:message for="loginDestinoMsgDialog" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<h:outputLabel for="mem_exigirrespostaMsgDialog"
						value="Exigir resposta: " id="labelExigeRespMsgDialog"
						style="width:300px;" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<p:selectBooleanCheckbox id="mem_exigirrespostaMsgDialog"
						value="#{mensagemBeanView.objetoSelecionado.mensagem_exigirResposta}" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<p:message for="mem_exigirrespostaMsgDialog" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<h:outputLabel for="mem_datahoraMsgDialog" value="Data envio: "
						id="labelDataMsgDialog" style="width:300px;" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<p:inputText id="mem_datahoraMsgDialog"
						value="#{mensagemBeanView.objetoSelecionado.mensagem_dataHora}"
						readonly="true">

						<f:convertDateTime locale="pt_BR" pattern="dd/MM/yyyy HH:mm:ss"
							dateStyle="long" timeStyle="full" timeZone="GMT-03:00" />
					</p:inputText>
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<p:message for="mem_datahoraMsgDialog" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<h:outputLabel for="mem_assuntoMsgDialog" value="Assunto: "
						id="labelAssuntoMsgDialog" style="width:300px;" />
				</p:row>
			</p:column>

			<p:column>
				<p:inputText id="mem_assuntoMsgDialog" immediate="false"
					style="width:480px;" maxlength="100"
					value="#{mensagemBeanView.objetoSelecionado.mensagem_assunto}"
					required="true" requiredMessage="Informe o assunto." />
			</p:column>

			<p:column>
				<p:row>
					<p:message for="mem_assuntoMsgDialog" />
				</p:row>
			</p:column>

			<p:column>
				<p:row>
					<h:outputLabel for="mem_mensagemMsgDialog" value="Mensagem: "
						id="labelMensagemMsgDialog" style="width:300px;" />
				</p:row>
			</p:column>

			<p:column>
				<p:inputTextarea id="mem_mensagemMsgDialog" autoResize="true"
					immediate="false" style="width:480px; heigth: 110px;"
					maxlength="1000"
					value="#{mensagemBeanView.objetoSelecionado.mensagem_mensagem}"
					required="true" requiredMessage="Informe a mensagem." />
			</p:column>

			<p:column>
				<p:row>
					<p:message for="mem_mensagemMsgDialog" />
				</p:row>
			</p:column>

		</p:panelGrid>

	</p:panel>

	<p:spacer heigth="50px;" />

	<p:commandButton value="Novo"
		style="height:40px;width:100px;background:#CDCDC1;border: 1px solid #FFFFFF;"
		rendered="#{contextoBean.possuiAcesso('MENSAGEM_ENVIAR_NOVO', 'ADMIN')}"
		actionListener="#{mensagemBeanView.novo}" ajax="true" id="buttonNovo"
		immediate="false" update="formCadastroMsgDialog, :formTemplate:msg">
		<p:ajax listener="#{mensagemBeanView.novo}" />
	</p:commandButton>

	<p:commandButton value="Salvar"
		style="height:40px;width:100px;background:#CDCDC1;border: 1px solid #FFFFFF;"
		rendered="#{contextoBean.possuiAcesso('MENSAGEM_ENVIAR_NOVO', 'ADMIN')}"
		actionListener="#{mensagemBeanView.saveNotReturn}" ajax="true"
		id="buttonSalvar" partialSubmit="true" process="@this, @form"
		immediate="false" update="formCadastroMsgDialog, :formTemplate:msg" />

	<p:commandButton value="Cancelar"
		style="height:40px;width:100px;background:#CDCDC1;border: 1px solid #FFFFFF;"
		onclick="enviarMsgDialog.hide();"
		actionListener="#{mensagemBeanView.novo}" ajax="true"
		id="buttonCancelar" immediate="false"
		update="formCadastroMsgDialog, :formTemplate:msg">
	</p:commandButton>

	<p:dialog widgetVar="destinoDialogMsgDialog"
		id="destinoDialogMsgDialog" modal="false" resizable="false"
		height="400px" dynamic="true" appendToBody="false"
		header="Consulta usuário destino">

		<util:pesquisa managedBeanView="#{funcionarioBeanView}"
			ocultaNovo="false" nomePesquisa="Pesquisa usuário" exibirBotaoAdd="true"
			colunasGridDataTableList="/resources/components/colunasDataTableFuncionario.xhtml"
			funcaoJavaScript="pesquisaUserDestinoPerderFocoDialog(#{objeto.ent_codigo}), destinoDialogMsgDialog.hide();">

		</util:pesquisa>

	</p:dialog>

</h:form>

</html>